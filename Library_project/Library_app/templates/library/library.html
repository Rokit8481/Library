{% extends 'base.html' %}

{% block title %}Бібліотека{% endblock %}

{% block content %}
<form id="genre-filter" class="d-flex flex-wrap gap-1">
  {% for genre in genres %}
      <input type="checkbox"
             class="btn-check"
             id="genre-{{ genre.id }}"
             name="genre"
             value="{{ genre.id }}"
             {% if genre.id|stringformat:"s" in selected_genres %}checked{% endif %}
             onchange="document.getElementById('genre-filter').submit()">
      <label class="btn btn-outline-primary" for="genre-{{ genre.id }}">
          {{ genre.name }}
      </label>
  {% endfor %}

  {% if selected_genres %}
      <a href="{% url 'library' %}" class="btn btn-outline-danger ms-2">Скинути</a>
  {% endif %}
</form>

  {% for book in books %}
    <div class="card mb-4 shadow-sm">
      <div class="row g-1">
        <div class="col-md-3 col-lg-2">
          <img src="{{ book.cover.url }}" alt="{{ book.title }}" class="w-100">
        </div>
            <div class="col-md-8">
            <div class="card-body">
            <h4 class="card-title"><i> "{{ book.title }}" </i></h4>
            <p class="card-text mb-1"><strong>ISBN: </strong>{{ book.isbn|default:"Не вказано" }}</p>
            <p class="mb-1"><strong>Автор: </strong> <a href="{% url 'author_detail' book.author.pk %}">{{ book.author.first_name }} {{ book.author.last_name }}</a></p>
            <p class="mb-1"><strong>Рік публікування: </strong>{{ book.year_published }}</p>
            <p class="mb-1"><strong>Вікові обмеження: </strong>{{ book.age_restrictions }}+</p>
            <p class="mb-1"><strong>Жанри:</strong>
              {% for genre in book.genre.all %}
                <strong class = "text-muted">{{ genre.name }}</strong>{% if not forloop.last %}, {% endif %}
              {% empty %}
                <em>Не вказано</em>
              {% endfor %}
            </p>
            <a href="{% url 'book_detail' book.pk %}" class="btn btn-xxl btn-outline-primary">Більше...</a>
          </div>
        </div>
      </div>
    </div>
  {% empty %}
    <div class="alert alert-info">Немає доступних книг.</div>
  {% endfor %}
</div>
{% endblock %}

